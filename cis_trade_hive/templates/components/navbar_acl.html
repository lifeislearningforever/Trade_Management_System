{% load static %}
{% load core_filters %}
<nav class="top-navbar">
    <!-- Left Side -->
    <div class="navbar-left">
        <!-- Mobile Menu Toggle -->
        <button class="navbar-icon d-md-none" id="sidebar-toggle">
            <i class="bi bi-list"></i>
        </button>

        <!-- Breadcrumb -->
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a href="{% url 'dashboard' %}">
                    <i class="bi bi-house-door"></i>
                </a>
            </li>
            {% block breadcrumb %}
                <li class="breadcrumb-item active">Dashboard</li>
            {% endblock %}
        </ol>
    </div>

    <!-- Right Side -->
    <div class="navbar-right">
        <!-- Search -->
        <form action="{% url 'global_search' %}" method="get" class="navbar-search d-none d-lg-block">
            <i class="bi bi-search"></i>
            <input type="text" placeholder="Search portfolios, trades..." id="global-search" name="q">
        </form>

        <!-- Icons -->
        <div class="navbar-icons">
            <!-- Notifications -->
            <button class="navbar-icon" id="notifications-btn" title="Notifications">
                <i class="bi bi-bell"></i>
            </button>

            <!-- Help -->
            <a href="/static/docs/index.html" target="_blank" class="navbar-icon" title="Help & Documentation">
                <i class="bi bi-question-circle"></i>
            </a>
        </div>

        <!-- User Menu -->
        <div class="user-menu" id="user-menu">
            <div class="user-avatar">
                {% with user_name=request.session.user_name|default:"U" %}
                    {{ user_name|slice:":1"|upper }}{% if user_name|wordcount > 1 %}{{ user_name|split:" "|last|slice:":1"|upper }}{% endif %}
                {% endwith %}
            </div>
            <div class="user-info d-none d-md-block">
                <div class="user-name">{{ request.session.user_name|default:"User" }}</div>
                <div class="user-role">{{ request.session.user_group_name|default:"User" }}</div>
            </div>
            <i class="bi bi-chevron-down d-none d-md-block"></i>
        </div>
    </div>
</nav>

<!-- User Dropdown Menu (Hidden by default) -->
<div class="dropdown-menu dropdown-menu-end" id="user-dropdown" style="display: none;">
    <div class="dropdown-header">
        <strong>{{ request.session.user_name|default:"User" }}</strong>
        <small class="d-block text-muted">{{ request.session.user_email|default:"" }}</small>
    </div>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="{% url 'logout' %}">
        <i class="bi bi-box-arrow-right"></i> Logout
    </a>
</div>
